name: Product Hunt Daily Analysis

# æ¯å¤©ä¸‹åˆ4ç‚¹10åˆ†è‡ªåŠ¨æ‰§è¡Œåˆ†æ
on:
  schedule:
    # UTCæ—¶é—´ï¼Œæ¯å¤©8:10 AM (åŒ—äº¬æ—¶é—´ä¸‹åˆ4:10)
    - cron: '10 8 * * *'
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘
    inputs:
      date:
        description: 'åˆ†ææ—¥æœŸ (YYYY-MM-DDï¼Œç•™ç©ºåˆ™åˆ†æå½“å¤©)'
        required: false
        default: ''

jobs:
  analyze-product-hunt:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
        cache: 'pip'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r code/requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
        
    - name: Run Product Hunt Analysis (Optimized Version)
      env:
        ANALYSIS_DATE: ${{ github.event.inputs.date || '' }}
      run: |
        cd code
        # è¿è¡Œä¼˜åŒ–ç‰ˆåˆ†æå™¨ï¼ˆCozeæ ¼å¼ä¸“ä¸šæŠ¥å‘Šï¼‰
        python optimized_product_hunt_analyzer.py
        
    - name: Commit and push changes
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        
        # æ·»åŠ æ‰€æœ‰æ–°ç”Ÿæˆçš„åˆ†ææŠ¥å‘Š
        git add -A
        
        # å¦‚æœæœ‰å˜æ›´ï¼Œåˆ™æäº¤
        if [ -n "$(git status --porcelain)" ]; then
          git commit -m "Auto-update Product Hunt analysis - $(date +'%Y-%m-%d %H:%M:%S')"
          git push
        else
          echo "No changes to commit"
        fi
        
    - name: Create Pull Request
      if: success()
      uses: peter-evans/create-pull-request@v6
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        branch: update-product-hunt-analysis
        title: "ğŸ“Š Product Hunt Daily Analysis Update"
        body: |
          ## Product Huntæ¯æ—¥åˆ†ææŠ¥å‘Šè‡ªåŠ¨æ›´æ–°
          
          æœ¬PRåŒ…å«æœ€æ–°çš„Product Huntçƒ­é—¨äº§å“åˆ†ææŠ¥å‘Šï¼š
          
          - **åˆ†ææ—¥æœŸ**: ${{ github.event.inputs.date || 'ä»Šå¤©' }}
          - **ç”Ÿæˆæ—¶é—´**: ${{ github.event.head_commit.timestamp }}
          - **æŠ¥å‘Šæ–‡ä»¶**: enhanced_product_hunt_analysis_*.md
          
          ### ğŸ“‹ æŠ¥å‘ŠåŒ…å«å†…å®¹ï¼š
          - æ¯æ—¥Product Huntçƒ­é—¨äº§å“è¯¦ç»†åˆ†æï¼ˆ15ä¸ªäº§å“ï¼‰
          - 9ç»´åº¦æ·±åº¦åˆ†æï¼ˆæ ¸å¿ƒåŠŸèƒ½ã€ç—›ç‚¹ã€å—ä¼—ã€ç«äº‰ç­‰ï¼‰
          - æ™ºèƒ½äº§å“åˆ†ç±»ï¼ˆ10å¤§ç±»åˆ«ï¼‰
          - **é‡åŒ–å¸‚åœºæ½œåŠ›è¯„åˆ†**ï¼ˆ0-100åˆ†ï¼‰
          - **ä¸“å®¶è¯„çº§ç³»ç»Ÿ**ï¼ˆâ­â­â­â­â­ï¼‰
          - 3ä¸ªæœ€å…·å‰æ™¯äº§å“æ¨è
          - å¸‚åœºè¶‹åŠ¿æ´å¯Ÿå’ŒæŠ•èµ„æœºä¼šåˆ†æ
          - æŠ•èµ„é£é™©æç¤ºå’Œæ§åˆ¶å»ºè®®
          
          ### ğŸš€ è‡ªåŠ¨åŒ–è¯´æ˜
          - æ¯æ—¥åŒ—äº¬æ—¶é—´ä¸‹åˆ4:10è‡ªåŠ¨æ‰§è¡Œ
          - åŸºäºdecohack.comæœ€æ–°æ¦œå•æ•°æ®
          - ä½¿ç”¨AIå¢å¼ºåˆ†ææä¾›ä¸“ä¸šæ´å¯Ÿ
          - **åŸºäºCozeæ ¼å¼çš„ä¸“ä¸šæŠ•èµ„æŠ¥å‘Šç»“æ„**
          
          ---
          *ğŸ“Š æ­¤æŠ¥å‘Šç”±MiniMax Agentè‡ªåŠ¨åŒ–ç”Ÿæˆ*
        commit-message: "Auto-update Product Hunt analysis - $(date +'%Y-%m-%d')"
        draft: false
